from Molecule.containers import Molecule
from Molecule.periodictable import *

m1 = Molecule()
m2 = Molecule()
m3 = Molecule()
m1.add_atom(N(), 1)
m1.add_atom(N(), 2)
m1.add_atom(N(), 3)
m1.add_atom(Br(), 4)
m1.add_atom(O(), 8)
m1.add_atom(O(), 10)
m1.add_bond(1, 2, 1)
m1.add_bond(2, 3, 1)
m1.add_bond(2, 10, 1)
m1.add_bond(3, 4, 1)
m1.add_bond(1, 8, 1)
m1.add_bond(1, 3, 1)

m2.add_atom(N(), 5)
m2.add_atom(N(), 6)
m2.add_atom(N(), 7)
m2.add_atom(O(), 9)
m2.add_bond(5, 6, 1)
#m2.add_bond(5, 7, 1)
m2.add_bond(6, 7, 1)
m2.add_bond(5, 9, 1)


m3.add_atom(N(), 1)
m3.add_atom(N(), 2)
m3.add_atom(N(), 3)
m3.add_atom(N(), 4)
m3.add_atom(N(), 5)
m3.add_atom(N(), 6)
m3.add_atom(N(), 7)
m3.add_atom(N(), 8)

m3.add_bond(1, 2, 1)
m3.add_bond(2, 3, 1)
m3.add_bond(3, 4, 1)
m3.add_bond(4, 5, 1)
m3.add_bond(5, 6, 1)
m3.add_bond(6, 1, 1)
m3.add_bond(1, 7, 1)
m3.add_bond(7, 8, 1)
m3.add_bond(8, 4, 1)

#print(next(m1.substructure_mappings(m2)))


m4 = Molecule()
m4.add_atom(N(), 4)
m4.add_atom(N(), 5)
m4.add_atom(N(), 9)
m4.add_atom(N(), 6)
m4.add_atom(N(), 7)
m4.add_atom(O(), 1)
m4.add_atom(O(), 2)
m4.add_atom(O(), 3)
m4.add_atom(Cl(), 10)
m4.add_atom(Cl(), 8)

m4.add_bond(1, 4, 1)
m4.add_bond(4, 9, 1)
m4.add_bond(9, 6, 1)
m4.add_bond(6, 3, 1)
m4.add_bond(5, 2, 1)
m4.add_bond(5, 9, 1)
m4.add_bond(9, 7, 1)
m4.add_bond(7, 8, 1)
m4.add_bond(7, 10, 1)

m5 = Molecule()
m5.add_atom(O(), 1)
m5.add_atom(N(), 2)
m5.add_atom(N(), 3)
m5.add_atom(N(), 4)
m5.add_atom(Cl(), 5)

m5.add_bond(1, 2, 1)
m5.add_bond(2, 3, 1)
m5.add_bond(3, 4, 1)
m5.add_bond(4, 5, 1)

print(list(m5.substructure_mappings(m4)))